<!DOCTYPE html>
<html>
<head>
    <title>Loan Calculator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function calculateAmortization(event) {
            event.preventDefault();

            const loanAmount = document.getElementById('loanAmount').value;
            const term = document.getElementById('term').value;
            const interestRate = document.getElementById('interestRate').value;

            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/cgi-bin/middleware.o', true);
            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const amortization = JSON.parse(xhr.responseText);
                    const table = $('<table>').append($('<thead>').append($('<tr>').append($('<th>').text('Payment No.')).append($('<th>').text('Principle Payable')).append($('<th>').text('Interest Payable')).append($('<th>').text('Total Amortization')).append($('<th>').text('Interest Rate')))).append($('<tbody>'));
                    for (let i = 0; i < amortization.length; i++) {
                        const row = $('<tr>').append($('<td>').text(amortization[i].paymentNo)).append($('<td>').text(amortization[i].principlePayable)).append($('<td>').text(amortization[i].interestPayable)).append($('<td>').text(amortization[i].totalAmortization)).append($('<td>').text(amortization[i].interestRate));
                        table.append(row);
                    }
                    $('#result').empty().append(table);
                }
            };
            xhr.send(JSON.stringify({loanAmount: loanAmount, term: term, interestRate: interestRate}));
        }
    </script>
</head>
<body>
    <h1>Loan Calculator</h1>
    <form onsubmit="calculateAmortization(event)">
        <label for="loanAmount">Loan Amount:</label>
        <input type="number" id="loanAmount" name="loanAmount" required><br>
        <label for="term">Term (Months):</label>
        <select id="term" name="term">
            <option value="1">1 month</option>
            <option value="2">2 months</option>
            <option value="3">3 months</option>
            <option value="4">4 months</option>
            <option value="5">5 months</option>
            <option value="6">6 months</option>
        </select><br>
        <label for="interestRate">Interest Rate:</label>
        <input type="number" id="interestRate" name="interestRate" step="0.01" required><br>
        <input type="submit" value="Calculate Amortization">
    </form>
    <div id="result"></div>
</body>
</html>
